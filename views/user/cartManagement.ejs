<%- include('../layouts/header') %>

    <!doctype html>
    <html lang="en">

    <!-- Mirrored from 3.37.186.116/cart-style2.html by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 21 May 2024 15:38:54 GMT -->
    <!-- Added by HTTrack -->
    <meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->

    <head>
        <!--Required Meta Tags-->
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="description">
        <!-- Title Of Site -->
        <title>Cart Page Style2 - Optimal Multipurpose eCommerce Bootstrap 5 Html Template</title>
        <!-- Favicon -->
        <link rel="shortcut icon" href="/assets/images/favicon.png" />
        <!-- Plugins CSS -->
        <link rel="stylesheet" href="/assets/css/plugins.css" />
        <!-- Main Style CSS -->
        <link rel="stylesheet" href="/assets/css/style.css" />
        <link rel="stylesheet" href="/assets/css/responsive.css" />
    </head>
    <style>
        #snackbar {
            visibility: hidden;
            min-width: 250px;
            margin-left: -125px;
            background-color: rgb(123, 7, 7);
            color: #fff;
            text-align: center;
            border-radius: 2px;
            padding: 16px;
            position: fixed;
            z-index: 1;
            left: 50%;
            bottom: 30px;
            font-size: 17px;
        }

        #snackbar.show {
            visibility: visible;
            -webkit-animation: fadein 0.5s, fadeout 0.5s 2.5s;
            animation: fadein 0.5s, fadeout 0.5s 2.5s;
        }

        @-webkit-keyframes fadein {
            from {
                bottom: 0;
                opacity: 0;
            }

            to {
                bottom: 30px;
                opacity: 1;
            }
        }

        @keyframes fadein {
            from {
                bottom: 0;
                opacity: 0;
            }

            to {
                bottom: 30px;
                opacity: 1;
            }
        }

        @-webkit-keyframes fadeout {
            from {
                bottom: 30px;
                opacity: 1;
            }

            to {
                bottom: 0;
                opacity: 0;
            }
        }

        @keyframes fadeout {
            from {
                bottom: 30px;
                opacity: 1;
            }

            to {
                bottom: 0;
                opacity: 0;
            }
        }
    </style>

    <body class="my-wishlist-page">
        <div id="snackbar"></div>

        <!-- Page Loader -->
        <div id="pre-loader"><img src="/assets/images/loader.gif" alt="Loading..." /></div>
        <!-- End Page Loader -->

        <!--Page Wrapper-->
        <div class="page-wrapper">
            <!--Header-->
            <div id="header" class="header">
                <div class="header-main">
                    <header class="header-wrap container d-flex align-items-center">
                        <div class="row g-0 align-items-center w-100">
                            <!--Social Icons-->
                            <div class="col-4 col-sm-4 col-md-4 col-lg-5 d-none d-lg-block">
                                
                            </div>
                            <!--End Social Icons-->
                            <!--Logo / Menu Toggle-->
                            <div class="col-6 col-sm-6 col-md-6 col-lg-2 d-flex">
                                <!--Mobile Toggle-->
                                <button type="button"
                                    class="btn--link site-header__menu js-mobile-nav-toggle mobile-nav--open me-3 d-lg-none"><i
                                        class="icon an an-times-l"></i><i class="icon an an-bars-l"></i></button>
                                <!--End Mobile Toggle-->
                                <!--Logo-->
                                <div class="logo mx-lg-auto"><a href="index.html"><img class="logo-img"
                                            src="/assets/images/logo.svg"
                                            alt="Optimal Multipurpose eCommerce Bootstrap 5 Html Template"
                                            title="Optimal Multipurpose eCommerce Bootstrap 5 Html Template" /><span
                                            class="logo-txt d-none">Optimal</span></a></div>
                                <!--End Logo-->
                            </div>
                            <!--End Logo / Menu Toggle-->
                            <!--Right Action-->
                            <div
                                class="col-6 col-sm-6 col-md-6 col-lg-5 icons-col text-right d-flex justify-content-end">
                                <!--Search-->
                                <div class="site-search iconset"><i class="icon an an-search-l"></i><span
                                        class="tooltip-label">Search</span></div>
                                <!--End Search-->
                                <!--Wishlist-->
                                <div class="wishlist-link iconset">
                                    <a href="my-wishlist.html"><i class="icon an an-heart-l"></i></span><span
                                            class="tooltip-label">Wishlist</span></a>
                                </div>
                                <!--End Wishlist-->
                                <!--Setting Dropdown-->
                                <div class="user-link iconset"><i class="icon an an-user-expand"></i><span
                                        class="tooltip-label">Account</span></div>
                                <div id="userLinks">
                                    <ul class="user-links">
                                        <li><a href="/login">Login</a></li>
                                        <li><a href="/register">Sign Up</a></li>
                                        <li><a href="my-wishlist.html">Wishlist</a></li>
                                        <li><a href="compare-style1.html">Compare</a></li>
                                    </ul>
                                </div>
                                <!--End Setting Dropdown-->
                                <!--Minicart Drawer-->
                                <div class="header-cart iconset">
                                    <a href="cart-style1.html" class="site-header__cart btn-minicart"
                                        data-bs-toggle="modal" data-bs-target="#minicart-drawer">
                                        <i class="icon an an-sq-bag"></i></span><span
                                            class="tooltip-label">Cart</span>
                                    </a>
                                </div>
                                <!--End Minicart Drawer-->

                            </div>
                            <!--End Right Action-->
                        </div>
                    </header>
                    <!--Main Navigation Desktop-->
                    <div class="menu-outer">
                        <nav class="container">
                            <div class="row">
                                <div class="col-1 col-sm-12 col-md-12 col-lg-12 align-self-center d-menu-col">
                                    <!--Desktop Menu-->
                                    <nav class="grid__item" id="AccessibleNav">
                                        <ul id="siteNav" class="site-nav medium center hidearrow">
                                            <li class="lvl1 parent megamenu"><a href="/">Home <i
                                                        class="an an-angle-down-l"></i></a>

                                            </li>
                                            <li class="lvl1 parent megamenu"><a href="/loadShopPAge">Shop <i
                                                        class="an an-angle-down-l"></i></a>

                                            </li>
                                            <li class="lvl1 parent megamenu"><a href="#;">Product <i
                                                        class="an an-angle-down-l"></i></a>

                                            </li>
                                           
                                        </ul>
                                    </nav>
                                    <!--End Desktop Menu-->
                                </div>
                            </div>
                        </nav>
                    </div>
                    <!--End Main Navigation Desktop-->

                </div>
            </div>
            <!--End Header-->


            <!--Body Container-->
            <div id="page-content">
                <!--Collection Banner-->
                <div class="collection-header">
                    <div class="collection-hero">
                        <div class="collection-hero__image"></div>
                        <div class="collection-hero__title-wrapper container">
                            <h1 class="collection-hero__title">Cart Page Style2</h1>
                            <div class="breadcrumbs text-uppercase mt-1 mt-lg-2"><a href="index.html"
                                    title="Back to the home page">Home</a><span>|</span><span class="fw-bold">Cart Page
                                    Style2</span></div>
                        </div>
                    </div>
                </div>
                <!--End Collection Banner-->

                <!--Main Content-->
                <div class="container">
                    <!--Cart Page-->
                    <!-- *********************************************************************************************** -->
                    <div class="row">
                        <div class="col-12 col-sm-12 col-md-12 col-lg-12 main-col">
                            <div class="alert alert-success py-2 rounded-1 alert-dismissible fade show cart-alert"
                                role="alert">
                                <i class="align-middle icon an an-truck icon-large me-2"></i><strong
                                    class="text-uppercase">Congratulations!</strong> You've got free shipping!
                                <button type="button" class="btn-close" data-bs-dismiss="alert"
                                    aria-label="Close"></button>
                            </div>

                            <form action="#" method="post" class="cart style1">
                                <table>
                                    <thead class="cart__row cart__header small--hide">
                                        <tr>
                                            <th class="action">&nbsp;</th>
                                            <th colspan="2" class="text-start">Product</th>
                                            <th class="text-center">Price</th>
                                            <th class="text-center">Quantity</th>
                                            <th class="text-center">Total</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <% let subtotal=0 ; %>
                                            <% cart.forEach((product)=>{ %>
                                                
                                                <tr class="cart__row border-bottom line1 cart-flex border-top">
                                                    <td data-product-id=""
                                                        onclick="removeFromCart('<%= product._id %>')"
                                                        class="cart-delete text-center small--hide"><a href="#"
                                                            class="btn btn--secondary cart__remove remove-icon position-static"
                                                            data-bs-toggle="tooltip" data-bs-placement="top"
                                                            title="Remove item"><i class="icon an an-times-r"></i></a>
                                                    </td>
                                                    <td class="cart__image-wrapper cart-flex-item">
                                                        <img src="/assets/productImages/<%= product.productImage[0]%>"
                                                            alt="<%= product.productName %>">
                                                    </td>
                                                    <td class="cart__meta small--text-left cart-flex-item">
                                                        <div class="list-view-item__title">
                                                            <a href="product-layout1.html">
                                                                <%= product.productName %>
                                                            </a>
                                                        </div>
                                                        <% if (product.offerName) { %>
                                                            <div class="offer-details">
                                                                <span class="offer-name">Offer: <%= product.offerName %></span>
                                                                <% if (product.discountPercentage) { %>
                                                                    <span class="discount-percentage">Discount: <%= product.discountPercentage %>% off</span>
                                                                <% } %>
                                                            </div>
                                                        <% } %>

                                                    </td>
                                                    <td
                                                        class="cart__price-wrapper cart-flex-item text-center small--hide">
                                                        <span class="money">
                                                            <%=product.price.toFixed(2)%>
                                                        </span>
                                                    </td>
                                                    <td
                                                        class="cart__update-wrapper cart-flex-item text-end text-md-center">
                                                        <div
                                                            class="cart__qty d-flex justify-content-end justify-content-md-center">
                                                            <div class="qtyField">
                                                                <a class="qtyBtn minus" 
                                                                   data-product-id="<%= product.productId %>" 
                                                                   onclick="decreaseQuantity(event)">
                                                                   <i class="icon an an-minus-r"></i>
                                                                </a>
                                                                <span class="quantity m-auto" id="quantity-<%= product.productId %>">
                                                                    <%= product.quantity %>
                                                                </span>
                                                                <a class="qtyBtn plus" 
                                                                   data-product-id="<%=  product.productId %>" 
                                                                   onclick="increaseQuantity(event)">
                                                                   <i class="icon an an-plus-r"></i>
                                                                </a>
                                                            </div>
                                                            
                                                        </div>
                                                    <td style="display: flex; justify-content: center;"
                                                        id="product-total-<%= product.productId %>" class="product-total">
                                                        
                                                        $<%= (product.price * product.quantity).toFixed(2) %>
                                                    </td>
                                        
                                                    <!-- Update the subtotal -->
                                                    <% subtotal += product.price * product.quantity; %>
                                                </tr>
                                        <% }) %>


                                    </tbody>
                                    <tfoot>
                                        <tr>
                                            <td colspan="3" class="text-start pt-3"><a href="/home"
                                                    class="btn btn--link d-inline-flex align-items-center btn--small p-0 cart-continue"><i
                                                        class="me-1 icon an an-angle-left-l"></i><span
                                                        class="text-decoration-underline">Continue shopping</span></a>
                                            </td>
                                            <td colspan="3" class="text-end pt-3">
                                                
                                            </td>
                                        </tr>
                                    </tfoot>
                                </table>
                            </form>
                        </div>
                    </div>
                    <!-- *********************************************************************************************************************************************** -->
                    <div class="row mt-2">
                        <div class="col-12 col-sm-12 col-md-12 col-lg-4 cart__footer">
                            <div class="solid-border">
                                <div class="row border-bottom pb-2">
                                    <span class="col-6 col-sm-6 cart__subtotal-title">Subtotal</span>
                                    <span class="col-6 col-sm-6 text-right"><span class="money" id="cart-subtotal">
                                        
                                        $<%=subtotal.toFixed(2) %></span></span>
                                </div>
                                <div class="row border-bottom pb-2 pt-2">
                                    <span class="col-6 col-sm-6 cart__subtotal-title">Tax</span>
                                    <span class="col-6 col-sm-6 text-right">$10.00</span>
                                </div>
                                <div class="row border-bottom pb-2 pt-2">
                                    <span class="col-6 col-sm-6 cart__subtotal-title">Shipping</span>
                                    <span class="col-6 col-sm-6 text-right">Free shipping</span>
                                </div>
                                <div class="row border-bottom pb-2 pt-2">
                                    <span class="col-6 col-sm-6 cart__subtotal-title" id="cart-grandtotal"><strong>Grand
                                            Total: $<%= (subtotal + 10).toFixed(2) %></strong></span>
                                    <span class="col-6 col-sm-6 cart__subtotal-title cart__subtotal text-right"><span
                                            class="money"> $<%= (subtotal + 10).toFixed(2) %></span></span>
                                </div>
                                <p class="cart__shipping m-0">Shipping &amp; taxes calculated at checkout</p>
                                <p class="cart__shipping pt-0 m-0 fst-normal freeShipclaim"><i
                                        class="me-1 align-middle icon an an-truck-l"></i><b>FREE SHIPPING</b> ELIGIBLE
                                </p>
                                <div class="customCheckbox cart_tearm">
                                    <input type="checkbox" value="allen-vela" id="cart_tearm">
                                    <label for="cart_tearm">I agree with the terms and conditions</label>
                                </div>
                                <%if(cart.length > 0){ %>

                                    <a href="/loadCheckout" id="cartCheckout"
                                        class="btn btn--small-wide rounded mt-4 checkout">Proceed To Checkout</a>
                               <% }else{%>
                                <button
                                class="btn btn--small-wide rounded mt-4 checkout"  onclick="showEmptyCartMessage()">Proceed To Checkout</button>
                             <%  } %>

                                <div class="paymnet-img"><img src="/assets/images/payment-img.jpg" alt="Payment" />
                                </div>
                                <p class="mt-2"><a href="#">Checkout with Multiple Addresses</a></p>
                            </div>
                        </div>
                    </div>
                    <!--End Cart Page-->
                </div>
                <!--End Main Content-->
            </div>
            <!--End Body Container-->

            <!--Footer-->
            <div class="footer footer-1">
                <div class="footer-top clearfix">
                    <div class="container">

                        <div class="row">
                            <div class="col-12 col-sm-12 col-md-4 col-lg-3 footer-links">
                                <h4 class="h4">Informations</h4>
                                <ul>
                                    <li><a href="my-account.html">My Account</a></li>
                                    <li><a href="aboutus-style1.html">About us</a></li>
                                    <li><a href="login.html">Login</a></li>
                                    <li><a href="privacy-policy.html">Privacy policy</a></li>
                                    <li><a href="#">Terms &amp; condition</a></li>
                                </ul>
                            </div>

                            <div class="col-12 col-sm-12 col-md-4 col-lg-3 footer-links">
                                <h4 class="h4">Customer Services</h4>
                                <ul>
                                    <li><a href="#">Request Personal Data</a></li>
                                    <li><a href="faqs-style1.html">FAQ's</a></li>
                                    <li><a href="contact-style1.html">Contact Us</a></li>
                                    <li><a href="#">Orders and Returns</a></li>
                                    <li><a href="#">Support Center</a></li>
                                </ul>
                            </div>
                            <div class="col-12 col-sm-12 col-md-12 col-lg-4 newsletter-col">
                                <div class="display-table pt-md-3 pt-lg-0">
                                    <div class="display-table-cell footer-newsletter">
                                        <form action="#" method="post">
                                            <label class="h4">NEWSLETTER SIGN UP</label>
                                            <p>Enter Your Email To Receive Daily News And Get 20% Off Coupon For All
                                                Items.</p>
                                            <div class="input-group">
                                                <input type="email"
                                                    class="brounded-start input-group__field newsletter-input mb-0"
                                                    name="EMAIL" value="" placeholder="Email address" required>
                                                <span class="input-group__btn">
                                                    <button type="submit" class="btn newsletter__submit rounded-end"
                                                        name="commit" id="Subscribe"><i
                                                            class="an an-envelope-l"></i></button>
                                                </span>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                                <ul class="list-inline social-icons mt-3 pt-1">
                                    <li class="list-inline-item"><a href="#" data-bs-toggle="tooltip"
                                            data-bs-placement="top" title="Facebook"><i class="an an-facebook"
                                                aria-hidden="true"></i></a></li>
                                    <li class="list-inline-item"><a href="#" data-bs-toggle="tooltip"
                                            data-bs-placement="top" title="Twitter"><i class="an an-twitter"
                                                aria-hidden="true"></i></a></li>
                                    <li class="list-inline-item"><a href="#" data-bs-toggle="tooltip"
                                            data-bs-placement="top" title="Pinterest"><i class="an an-pinterest-p"
                                                aria-hidden="true"></i></a></li>
                                    <li class="list-inline-item"><a href="#" data-bs-toggle="tooltip"
                                            data-bs-placement="top" title="Instagram"><i class="an an-instagram"
                                                aria-hidden="true"></i></a></li>
                                    <li class="list-inline-item"><a href="#" data-bs-toggle="tooltip"
                                            data-bs-placement="top" title="TikTok"><i class="an an-tiktok"
                                                aria-hidden="true"></i></a></li>
                                    <li class="list-inline-item"><a href="#" data-bs-toggle="tooltip"
                                            data-bs-placement="top" title="Whatsapp"><i class="an an-whatsapp"
                                                aria-hidden="true"></i></a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="footer-bottom clearfix">
                    <div class="container">
                        <div class="d-flex-center flex-column justify-content-md-between flex-md-row-reverse">
                            <img src="/assets/images/payment.png" alt="Paypal Visa Payments" />
                            <div class="copytext text-uppercase">&copy; 2023 Optimal. All Rights Reserved.</div>
                        </div>
                    </div>
                </div>
            </div>
            <!--End Footer-->

            <!--Scoll Top-->
            <span id="site-scroll"><i class="icon an an-chevron-up"></i></span>
            <!--End Scoll Top-->
            <div class="modalOverly"></div>


            <!-- Including Jquery -->
            <script src="/assets/js/vendor/jquery-min.js"></script>
            <script src="/assets/js/vendor/js.cookie.js"></script>
            <!--Including Javascript-->
            <script src="/assets/js/plugins.js"></script>
            <script src="/assets/js/main.js"></script>

            <script>
                 function showEmptyCartMessage() {
        showSnackbar("Your cart is empty!");
    }

           

                function decreaseQuantity(event) {

                    const productId = event.currentTarget.getAttribute('data-product-id')
                    const quantityElement = document.getElementById(`quantity-${productId}`);
                    let currentQuantity = parseInt(quantityElement.innerText);
                    
                    if (currentQuantity > 1) {
                        updateQuantity(productId, -1);                        
                    } else {
                        Swal.fire({
                            title: "Quantity cannot be less than 1",
                            icon: "warning"
                        });
                    }
                }

                function increaseQuantity(event) {
                    const productId = event.currentTarget.getAttribute('data-product-id')                    
                    const quantityElement = document.getElementById(`quantity-${productId}`);
                    let currentQuantity = parseInt(quantityElement.innerText);

                    if (currentQuantity < 10) {
                        updateQuantity(productId, 1);
                    } else {
                        Swal.fire({
                            title: "Maximum quantity exceeded",
                            icon: "warning"
                        });
                    }
                }



                function updateQuantity(productId,change) {
                        fetch('/updateQuantity', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({ productId, change})

                    }).then(response => response.json())
                        .then(({ success, newQuantity, productPrice, newSubtotal, newGrandTotal }) => {
                            if (success) {
                                
                                document.getElementById(`quantity-${productId}`).textContent = newQuantity;
                                const productTotal = newQuantity * productPrice;
                    
                                document.getElementById(`product-total-${productId}`).textContent = `${productTotal.toFixed(2)}`;
                                // Update the cart subtotal and grand total
                                document.getElementById('cart-subtotal').textContent = `$${newSubtotal.toFixed(2)}`;
                                document.getElementById('cart-grandtotal').textContent = `$${newGrandTotal.toFixed(2)}`;

                            } else {
                                Swal.fire({
                                    title: 'Failed to update quantity',
                                    text: 'Please try again.',
                                    icon: 'error',
                                });
                            }
                        })
                        .catch(error => {
                            console.error('Error:', error);
                            Swal.fire({
                                title: 'Error',
                                text: 'Something went wrong. Please try again later.',
                                icon: 'error',
                            });
                        })
                }
               


                function removeFromCart(productId) {
                    //   const productId=event.target.getAttribute('data-product-id')  

                    fetch(`/removeFromCart?productId=${productId}`, {
                        method: 'DELETE'
                    }).then(response => {
                        if (response.ok) {
                            location.reload()
                        } else {
                            res.send(message, 'failde to remove from cart')
                        }
                    }).catch(error => console.error('error:', error))
                }

          
            </script>
            <script>
                

                                function showSnackbar(text) {
                var x = document.getElementById("snackbar");
                x.innerHTML=text
                x.className = "show";
                setTimeout(function(){ x.className = x.className.replace("show", ""); }, 3000);
}
            </script>
        </div>
        <!--End Page Wrapper-->
        <%- include('../layouts/footer') %>